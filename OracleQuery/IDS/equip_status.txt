select l.mpe_id,
       l.mpe_type,
       l.mpe_name,
       case
          when l.mpe_state = 1                           then
             'Connected'
          when l.last_connected is null then
             'Disconnected (No Data)'
          when ( sysdate - l.last_connected ) * 24 < 120 then
             'Disconnected - Yellow'
          else
             'Disconnected - Red'
       end as status,
       case
          when l.mpe_state = 1                           then
             'good'
          when l.last_connected is null then
             'fail'
          when ( sysdate - l.last_connected ) * 24 < 120 then
             'pass'
          else
             'fail'
       end as status_style,
       to_char(
          l.last_connected,
          'mm/dd/yyyy hh24:mi:ss'
       ) as last_connected,
       nvl(
          l.software_version,
          '-'
       ) as sw_version,
       nvl(
          l.hardware_version,
          '-'
       ) as hw_version,
       nvl(
          l.interface_version,
          '-'
       ) as if_version,
       l.mpe_serial_num,
       to_char(
          l.last_mailpiece,
          'mm/dd/yyyy hh24:mi:ss'
       ) as last_mailpiece,
       to_char(
          l.last_ulx,
          'mm/dd/yyyy hh24:mi:ss'
       ) as last_ulx,
       to_char(
          l.last_machstat,
          'mm/dd/yyyy hh24:mi:ss'
       ) as last_machstat,
       to_char(
          l.last_spload,
          'mm/dd/yyyy hh24:mi:ss'
       ) as last_spload
  from DCSDBA.mpe_list l
 where l.mpe_in_config_file = 1
 order by l.mpe_name